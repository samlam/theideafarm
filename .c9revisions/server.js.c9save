{"ts":1360043575298,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"\"use strict\";\r\n/**\r\n * Module dependencies.\r\n */\r\nvar com = require('./common.js');\r\nvar Express = require('express')\r\n    , routes = require('./routes')\r\n    , util = require('util')\r\n    , http = require('http');\r\n\r\n//var app = module.exports = express.createServer();  /// before express 3\r\nvar app = new Express();\r\nvar server = http.createServer(app);\r\n\r\nvar setHeaders = function (req, res, next) {\r\n    \r\n    res.header(\"X-Powered-By\", \"nodejs\");\r\n    // if ajax set access control\r\n    //if (req.xhr) { \r\n    //res.header(\"Access-Control-Allow-Origin\",'http://owa.samlam.com,http://owa.samlam.com:8001,http://owa.samlam.com:8000,http://w2k8dev1:8001,http://192.168.0.143:8001'); \r\n    res.header(\"Access-Control-Allow-Origin\", '*');\r\n    res.header(\"Access-Control-Allow-Headers\", \"X-Requested-With\");\r\n    res.header(\"X-UA-Compatible\", \"IE=edge,chrome=1\");\r\n    //}\r\n    return next();\r\n}\r\n\r\n// Configuration\r\napp.configure(function () {\r\n    app.use(setHeaders);\r\n    app.set('views', __dirname + '/views');\r\n    app.set('view engine', 'jade');\r\n    app.set('view options', { layout: false });\r\n    app.use(Express.compress());\r\n    app.use(Express.bodyParser({ keepExtensions: true, uploadDir: __dirname + '/public/uploads' }));\r\n    app.use(Express.methodOverride());\r\n    app.use(app.router);\r\n    app.use(Express.static(__dirname + '/public'));\r\n    app.use('/scripts', Express.static(__dirname + '/scripts'));\r\n});\r\n\r\napp.configure('development', function(){\r\n    app.use(Express.errorHandler({ dumpExceptions: true, showStack: true }));\r\n});\r\n\r\napp.configure('production', function(){\r\n    app.use(Express.errorHandler());\r\n});\r\n\r\n// Routes\r\n///upload example\r\napp.get('/upload', routes.upload);\r\napp.get('/upload2', routes.upload2);\r\napp.post('/upload', function (req, res, next) {\r\n    console.log(req.body);\r\n    console.log(req.files);\r\n    //res.header('Content-Type', 'application/json');\r\n    //return next();\r\n    res.send(200);\r\n});\r\n\r\n///default landing page\r\n//app.get('/', routes.index);\r\napp.get('/', routes.v2);\r\n\r\n//app.listen(process.env.port || 8000);   /// before express 3\r\nserver.listen(process.env.port || global.APPPORT);\r\n\r\nprocess.on('uncaughtException', function (e) {\r\n    var msg = util.inspect(e, 5);\r\n    console.log(msg);\r\n});\r\n\r\nconsole.log(\"Express server listening on port %d in %s mode\", server.address().port , app.settings.env);\r\n\r\n\r\n\r\n"]],"start1":0,"start2":0,"length1":0,"length2":2388}]],"length":2388}
{"contributors":[],"silentsave":false,"ts":1360044054531,"patch":[[{"diffs":[[0,"process.env."],[-1,"port"],[1,"PORT"],[0," || global.A"]],"start1":2123,"start2":2123,"length1":28,"length2":28}]],"length":2388,"saved":false}
{"contributors":[],"silentsave":false,"ts":1360045983228,"patch":[[{"diffs":[[0,"pts'));\r\n});\r\n\r\n"],[1,"console.log(__dirname + '/scripts');\r\n"],[0,"app.configure('d"]],"start1":1417,"start2":1417,"length1":32,"length2":70}]],"length":2426,"saved":false}
{"ts":1360046063990,"patch":[[{"diffs":[[0,"\r\n\r\n"],[-1,"console.log(__dirname + '/scripts');\r\n"],[0,"app."]],"start1":1429,"start2":1429,"length1":46,"length2":8},{"diffs":[[0,"\n});\r\n\r\n"],[1,"console.log('physical path :' + __dirname);\r\n"],[0,"console."]],"start1":2268,"start2":2268,"length1":16,"length2":61}]],"length":2433,"saved":false}
{"contributors":[],"silentsave":false,"ts":1360051146944,"patch":[[{"diffs":[[0,"{ \r\n"],[-1,"    //res.header(\"Access-Control-Allow-Origin\",'http://owa.samlam.com,http://owa.samlam.com:8001,http://owa.samlam.com:8000,http://w2k8dev1:8001,http://192.168.0.143:8001'); \r\n"],[0,"    "]],"start1":509,"start2":509,"length1":184,"length2":8}]],"length":2257,"saved":false}
